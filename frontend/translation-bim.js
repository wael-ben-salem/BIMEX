// translations.js
const translations = {
    fr: {
        // Titres et en-t√™tes
        "title": "BIMEX - Interface d'Analyse Intelligente BIM",
        "home_title": "Centre de Contr√¥le BIMEX",
        "welcome_message": "Intelligence Artificielle pour l'Analyse BIM Avanc√©e",
        
        // √âtapes de mission
        "step_upload": "Initialisation",
        "step_analysis": "Analyse Compl√®te",
        "step_classification": "Classification IA",
        "step_pmr": "Analyse PMR",
        "step_assistant": "Assistant IA",
        "step_costs": "Pr√©diction Co√ªts IA",
        "step_environment": "Analyse Environnementale",
        "step_optimization": "Optimisation IA",
        "step_anomalies": "D√©tection Anomalies",
        "step_report": "Rapport PDF",
        
        // Statuts
        "status_pending": "En Attente",
        "status_running": "En Cours",
        "status_completed": "Termin√©",
        "status_error": "Erreur",
        "status_ready": "Pr√™t",
        "status_online": "En ligne",
        "status_operational": "Syst√®me Op√©rationnel",
        "file_detected_status": "Fichier D√©tect√©",
        
        // Textes d'interface
        "file_detected": "‚úÖ Fichier D√©tect√© Automatiquement",
        "auto_detection": "Syst√®me de d√©tection automatique activ√©",
        "system_ready": "Syst√®me Pr√™t pour l'Analyse Automatique",
        "workflow_automation": "Workflow Automation",
        "execute_workflow": "Ex√©cuter Workflow Complet",
        "pause": "Pause",
        "stop": "Arr√™ter",
        "refresh": "Actualiser",
        "bi_analytics": "Analytics BI en Temps R√©el",
        
        // √âl√©ments BIM
        "bim_elements": "√âl√©ments BIM",
        "anomalies": "Anomalies",
        "performance": "Performance",
        "usage": "Utilisation",
        
        // M√©triques
        "quality": "Qualit√©",
        "compliance": "Conformit√©",
        "completeness": "Compl√©tude",
        "structural": "Structure",
        "mep_systems": "Syst√®mes MEP",
        "spatial_analysis": "Analyse Spatiale",
        "global_quality": "Qualit√© Globale",
        "efficiency": "Efficacit√©",
        "sustainability": "Durabilit√©",
        "cost_effectiveness": "Rentabilit√©",
        "innovation": "Innovation",
        
        // Widgets et sections
        "project_health": "Sant√© du Projet",
        "anomaly_heatmap": "Heatmap des Anomalies",
        "cost_predictor": "Pr√©dicteur de Co√ªts IA",
        "analysis_timeline": "Timeline des Analyses",
        "performance_radar": "Radar de Performance Multi-Dimensionnel",
        "bim_intelligence": "Analyse BIM Intelligente",
        "smart_performance": "Smart Performance Dashboard",
        "innovation_lab": "Innovation Lab",
        "semantic_analysis": "Analyse S√©mantique BIM",
        "connectivity_matrix": "Matrice de Connectivit√©",
        "geometric_analysis": "Analyse G√©om√©trique Avanc√©e",
        "bim_intelligence_hub": "BIM Intelligence Hub",
        
        // Boutons et actions
        "start_analysis": "D√©marrer l'Analyse",
        "reset": "R√©initialiser",
        "download_report": "T√©l√©charger Rapport",
        "view_details": "Voir D√©tails",
        "send": "Envoyer",
        "clear": "Effacer",
        "test_reset": "R√©initialiser (Test)",
        
        // Messages d'activit√©
        "initializing": "Initialisation du dashboard...",
        "analyzing": "Analyse en cours...",
        "processing": "Traitement des donn√©es...",
        "generating_report": "G√©n√©ration du rapport...",
        
        // Textes des onglets
        "tab_analysis": "Analyse",
        "tab_anomalies": "Anomalies",
        "tab_classification": "Classification",
        "tab_pmr": "PMR",
        "tab_costs": "Co√ªts IA",
        "tab_environment": "Environnement",
        "tab_optimization": "Optimisation IA",
        "tab_assistant": "Assistant IA",
        
        // Textes des informations de fichier
        "file": "Fichier:",
        "project": "Projet:",
        "path": "Chemin:",
        "source": "Source:",
        "xeokit_source": "XeoKit BIM Viewer",
        
        // Textes suppl√©mentaires
        "real_time_activity": "Activit√© en Temps R√©el",
        "live": "LIVE",
        "workflow_diagram": "Diagramme de Workflow",
        "legend_pending": "En attente",
        "legend_running": "En cours",
        "legend_completed": "Termin√©",
        "legend_error": "Erreur",
        "start": "D√©marrage",
        "comprehensive_analysis": "Analyse Compl√®te",
        "ia_classification": "Classification IA",
        "pmr_analysis": "Analyse PMR",
        "cost_prediction": "Pr√©diction Co√ªts",
        "environmental_analysis": "Analyse Environnementale",
        "ia_optimization": "Optimisation IA",
        "anomaly_detection": "D√©tection Anomalies",
        "ia_assistant": "Assistant IA",
        "final_report": "Rapport Final",
        "metric_evolution": "üìà √âvolution des M√©triques",
        "anomaly_distribution": "üéØ Distribution des Anomalies",
        "element_distribution": "üèóÔ∏è R√©partition des √âl√©ments",
        "system_health": "‚ö° Sant√© du Syst√®me",
        "ai_prediction": "üß† Intelligence Pr√©dictive BIM",
        "smart_insights": "üîÆ Pr√©dictions Intelligentes",
        "ai_insights": "IA Insights",
        "performance_insights": "Performance Insights",
        "innovation_insights": "Innovation Insights",
        
        // Nouvelles cl√©s ajout√©es
        "timeline_analyses": "‚è±Ô∏è Analysis Timeline",
        "cost_predictor_ai": "üí∞ AI Cost Predictor",
        "performance_radar": "üéØ Multi-Dimensional Performance Radar",
        "predictive_intelligence": "üß† BIM Predictive Intelligence",
        "bim_intelligence_hub": "üß† BIM Intelligence Hub",
        "intelligent_bim_analysis": "üß† Intelligent BIM Analysis",
        "innovation_lab": "üöÄ Innovation Lab",
        "smart_performance_dashboard": "üéØ Smart Performance Dashboard",
        "semantic_bim_analysis": "üß† BIM Semantic Analysis",
        "connectivity_matrix": "üèóÔ∏è Connectivity Matrix",
        "geometric_analysis": "üìê Advanced Geometric Analysis",
        "file_detected_auto": "‚úÖ File Automatically Detected",
        "real_time_activity": "Real-time Activity",
        "real_time_analytics": "Real-time BI Analytics",
        "workflow_diagram": "Workflow Diagram",
        "anomalies_heatmap": "üî• Anomalies Heatmap",
        "close": "Close",
        "previous": "Previous",
        "next": "Next",
        "start": "Start"
    },
    en: {
        // Titles and headers
        "title": "BIMEX - Intelligent BIM Analysis Interface",
        "home_title": "BIMEX Mission Control",
        "welcome_message": "Artificial Intelligence for Advanced BIM Analysis",
        
        // Mission steps
        "step_upload": "Initialization",
        "step_analysis": "Comprehensive Analysis",
        "step_classification": "AI Classification",
        "step_pmr": "Accessibility Analysis",
        "step_assistant": "AI Assistant",
        "step_costs": "AI Cost Prediction",
        "step_environment": "Environmental Analysis",
        "step_optimization": "AI Optimization",
        "step_anomalies": "Anomaly Detection",
        "step_report": "PDF Report",
        
        // Statuses
        "status_pending": "Pending",
        "status_running": "Running",
        "status_completed": "Completed",
        "status_error": "Error",
        "status_ready": "Ready",
        "status_online": "Online",
        "status_operational": "System Operational",
        "file_detected_status": "File Detected",
        
        // Interface texts
        "file_detected": "‚úÖ File Automatically Detected",
        "auto_detection": "Automatic detection system activated",
        "system_ready": "System Ready for Automatic Analysis",
        "workflow_automation": "Workflow Automation",
        "execute_workflow": "Execute Full Workflow",
        "pause": "Pause",
        "stop": "Stop",
        "refresh": "Refresh",
        "bi_analytics": "Real-Time BI Analytics",
        
        // BIM elements
        "bim_elements": "BIM Elements",
        "anomalies": "Anomalies",
        "performance": "Performance",
        "usage": "Usage",
        
        // Metrics
        "quality": "Quality",
        "compliance": "Compliance",
        "completeness": "Completeness",
        "structural": "Structure",
        "mep_systems": "MEP Systems",
        "spatial_analysis": "Spatial Analysis",
        "global_quality": "Global Quality",
        "efficiency": "Efficiency",
        "sustainability": "Sustainability",
        "cost_effectiveness": "Cost Effectiveness",
        "innovation": "Innovation",
        
        // Widgets and sections
        "project_health": "Project Health",
        "anomaly_heatmap": "Anomaly Heatmap",
        "cost_predictor": "AI Cost Predictor",
        "analysis_timeline": "Analysis Timeline",
        "performance_radar": "Multi-Dimensional Performance Radar",
        "bim_intelligence": "Intelligent BIM Analysis",
        "smart_performance": "Smart Performance Dashboard",
        "innovation_lab": "Innovation Lab",
        "semantic_analysis": "BIM Semantic Analysis",
        "connectivity_matrix": "Connectivity Matrix",
        "geometric_analysis": "Advanced Geometric Analysis",
        "bim_intelligence_hub": "BIM Intelligence Hub",
        
        // Buttons and actions
        "start_analysis": "Start Analysis",
        "reset": "Reset",
        "download_report": "Download Report",
        "view_details": "View Details",
        "send": "Send",
        "clear": "Clear",
        "test_reset": "Reset (Test)",
        
        // Activity messages
        "initializing": "Initializing dashboard...",
        "analyzing": "Analyzing...",
        "processing": "Processing data...",
        "generating_report": "Generating report...",
        
        // Tab texts
        "tab_analysis": "Analysis",
        "tab_anomalies": "Anomalies",
        "tab_classification": "Classification",
        "tab_pmr": "Accessibility",
        "tab_costs": "AI Costs",
        "tab_environment": "Environment",
        "tab_optimization": "AI Optimization",
        "tab_assistant": "AI Assistant",
        
        // File information texts
        "file": "File:",
        "project": "Project:",
        "path": "Path:",
        "source": "Source:",
        "xeokit_source": "XeoKit BIM Viewer",
        
        // Additional texts
        "real_time_activity": "Real-time Activity",
        "live": "LIVE",
        "workflow_diagram": "Workflow Diagram",
        "legend_pending": "Pending",
        "legend_running": "Running",
        "legend_completed": "Completed",
        "legend_error": "Error",
        "start": "Start",
        "comprehensive_analysis": "Comprehensive Analysis",
        "ia_classification": "AI Classification",
        "pmr_analysis": "PMR Analysis",
        "cost_prediction": "Cost Prediction",
        "environmental_analysis": "Environmental Analysis",
        "ia_optimization": "AI Optimization",
        "anomaly_detection": "Anomaly Detection",
        "ia_assistant": "AI Assistant",
        "final_report": "Final Report",
        "metric_evolution": "üìà Metrics Evolution",
        "anomaly_distribution": "üéØ Anomaly Distribution",
        "element_distribution": "üèóÔ∏è Element Distribution",
        "system_health": "‚ö° System Health",
        "ai_prediction": "üß† BIM Predictive Intelligence",
        "smart_insights": "üîÆ Smart Predictions",
        "ai_insights": "AI Insights",
        "performance_insights": "Performance Insights",
        "innovation_insights": "Innovation Insights",
        
        // Nouvelles cl√©s ajout√©es
        "timeline_analyses": "Timeline des Analyses",
        "cost_predictor_ai": "Pr√©dicteur de Co√ªts IA",
        "performance_radar": "Radar de Performance Multi-Dimensionnel",
        "predictive_intelligence": "Intelligence Pr√©dictive BIM",
        "bim_intelligence_hub": "BIM Intelligence Hub",
        "intelligent_bim_analysis": "Analyse BIM Intelligente",
        "innovation_lab": "Innovation Lab",
        "smart_performance_dashboard": "Smart Performance Dashboard",
        "semantic_bim_analysis": "Analyse S√©mantique BIM",
        "connectivity_matrix": "Matrice de Connectivit√©",
        "geometric_analysis": "Analyse G√©om√©trique Avanc√©e",
        "file_detected_auto": "Fichier D√©tect√© Automatiquement",
        "real_time_activity": "Activit√© en Temps R√©el",
        "real_time_analytics": "Analytics BI en Temps R√©el",
        "workflow_diagram": "Diagramme de Workflow",
        "anomalies_heatmap": "Heatmap des Anomalies",
        "close": "Fermer",
        "previous": "Pr√©c√©dent",
        "next": "Suivant",
        "start": "D√©marrer"
    },
    de: {
        // Titel und √úberschriften
        "title": "BIMEX - Intelligente BIM-Analyseoberfl√§che",
        "home_title": "BIMEX Missionskontrollzentrum",
        "welcome_message": "K√ºnstliche Intelligenz f√ºr erweiterte BIM-Analyse",
        
        // Missionsschritte
        "step_upload": "Initialisierung",
        "step_analysis": "Umfassende Analyse",
        "step_classification": "KI-Klassifizierung",
        "step_pmr": "Barrierefreiheitsanalyse",
        "step_assistant": "KI-Assistent",
        "step_costs": "KI-Kostenprognose",
        "step_environment": "Umweltanalyse",
        "step_optimization": "KI-Optimierung",
        "step_anomalies": "Anomalieerkennung",
        "step_report": "PDF-Bericht",
        
        // Status
        "status_pending": "Ausstehend",
        "status_running": "L√§uft",
        "status_completed": "Abgeschlossen",
        "status_error": "Fehler",
        "status_ready": "Bereit",
        "status_online": "Online",
        "status_operational": "System Betriebsbereit",
        "file_detected_status": "Datei erkannt",
        
        // Interface-Texte
        "file_detected": "‚úÖ Datei automatisch erkannt",
        "auto_detection": "Automatisches Erkennungssystem aktiviert",
        "system_ready": "System bereit f√ºr automatische Analyse",
        "workflow_automation": "Workflow-Automatisierung",
        "execute_workflow": "Vollst√§ndigen Workflow ausf√ºhren",
        
        "pause": "Pause",
        "stop": "Stopp",
        "refresh": "Aktualisieren",
        "bi_analytics": "Echtzeit-BI-Analytics",
        
        // BIM-Elemente
        "bim_elements": "BIM-Elemente",
        "anomalies": "Anomalien",
        "performance": "Leistung",
        "usage": "Nutzung",
        
        // Metriken
        "quality": "Qualit√§t",
        "compliance": "Konformit√§t",
        "completeness": "Vollst√§ndigkeit",
        "structural": "Struktur",
        "mep_systems": "MEP-Systeme",
        "spatial_analysis": "Raumanalyse",
        "global_quality": "Globale Qualit√§t",
        "efficiency": "Effizienz",
        "sustainability": "Nachhaltigkeit",
        "cost_effectiveness": "Kosteneffizienz",
        "innovation": "Innovation",
        
        // Widgets und Bereiche
        "project_health": "Projektzustand",
        "anomaly_heatmap": "Anomalie-Heatmap",
        "cost_predictor": "KI-Kostenprognose",
        "analysis_timeline": "Analyse-Zeitplan",
        "performance_radar": "Mehrdimensionales Leistungsradar",
        "bim_intelligence": "Intelligente BIM-Analyse",
        "smart_performance": "Smart Performance Dashboard",
        "innovation_lab": "Innovationslabor",
        "semantic_analysis": "BIM-Semantikanalyse",
        "connectivity_matrix": "Konnektivit√§tsmatrix",
        "geometric_analysis": "Erweiterte geometrische Analyse",
        "bim_intelligence_hub": "BIM Intelligence Hub",
        
        // Schaltfl√§chen und Aktionen
        "start_analysis": "Analyse starten",
        "reset": "Zur√ºcksetzen",
        "download_report": "Bericht herunterladen",
        "view_details": "Details anzeigen",
        "send": "Senden",
        "clear": "L√∂schen",
        "test_reset": "Zur√ºcksetzen (Test)",
        
        // Aktivit√§tsnachrichten
        "initializing": "Dashboard wird initialisiert...",
        "analyzing": "Analyse l√§uft...",
        "processing": "Daten werden verarbeitet...",
        "generating_report": "Bericht wird generiert...",
        
        // Tab-Texte
        "tab_analysis": "Analyse",
        "tab_anomalies": "Anomalien",
        "tab_classification": "Klassifizierung",
        "tab_pmr": "Barrierefreiheit",
        "tab_costs": "KI-Kosten",
        "tab_environment": "Umwelt",
        "tab_optimization": "KI-Optimierung",
        "tab_assistant": "KI-Assistent",
        
        // Dateiinformationstexte
        "file": "Datei:",
        "project": "Projekt:",
        "path": "Pfad:",
        "source": "Quelle:",
        "xeokit_source": "XeoKit BIM Viewer",
        
        // Zus√§tzliche Texte
        "real_time_activity": "Echtzeit-Aktivit√§t",
        "live": "LIVE",
        "workflow_diagram": "Workflow-Diagramm",
        "legend_pending": "Ausstehend",
        "legend_running": "L√§uft",
        "legend_completed": "Abgeschlossen",
        "legend_error": "Fehler",
        "start": "Start",
        "comprehensive_analysis": "Umfassende Analyse",
        "ia_classification": "KI-Klassifizierung",
        "pmr_analysis": "PMR-Analyse",
        "cost_prediction": "Kostenprognose",
        "environmental_analysis": "Umweltanalyse",
        "ia_optimization": "KI-Optimierung",
        "anomaly_detection": "Anomalieerkennung",
        "ia_assistant": "KI-Assistent",
        "final_report": "Abschlussbericht",
        "metric_evolution": "üìà Metrikentwicklung",
        "anomaly_distribution": "üéØ Anomalieverteilung",
        "element_distribution": "üèóÔ∏è Elementverteilung",
        "system_health": "‚ö° Systemzustand",
        "ai_prediction": "üß† BIM-Pr√§diktive Intelligenz",
        "smart_insights": "üîÆ Intelligente Vorhersagen",
        "ai_insights": "KI-Erkenntnisse",
        "performance_insights": "Leistungserkenntnisse",
        "innovation_insights": "Innovationserkenntnisse",
        
        // Nouvelles cl√©s ajout√©es
        "timeline_analyses": "‚è±Ô∏è Analyse-Zeitplan",
        "cost_predictor_ai": "üí∞ KI-Kostenprognose",
        "performance_radar": "üéØ Mehrdimensionales Leistungsradar",
        "predictive_intelligence": "üß† BIM-Pr√§diktive Intelligenz",
        "bim_intelligence_hub": "üß† BIM-Intelligenz-Hub",
        "intelligent_bim_analysis": "üß† Intelligente BIM-Analyse",
        "innovation_lab": "üöÄ Innovationslabor",
        "smart_performance_dashboard": "üéØ Intelligentes Leistungsdashboard",
        "semantic_bim_analysis": "üß† BIM-Semantikanalyse",
        "connectivity_matrix": "üèóÔ∏è Konnektivit√§tsmatrix",
        "geometric_analysis": "üìê Erweiterte geometrische Analyse",
        "file_detected_auto": "‚úÖ Datei automatisch erkannt",
        "real_time_activity": "Echtzeit-Aktivit√§t",
        "real_time_analytics": "Echtzeit-BI-Analytik",
        "workflow_diagram": "Workflow-Diagramm",
        "anomalies_heatmap": "üî• Anomalie-Heatmap",
        "close": "Schlie√üen",
        "previous": "Zur√ºck",
        "next": "Weiter",
        "start": "Start"
    }
};

// Fonction pour changer la langue
function changeLanguage(lang) {
    if (!translations[lang]) return;
    
    // Mettre √† jour les √©l√©ments avec l'attribut data-translate
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
    
    // Mettre √† jour les textes des statuts des √©tapes
    updateStepStatusTexts(lang);
    
    // Mettre √† jour les textes dynamiques suppl√©mentaires
    updateDynamicTexts(lang);
    
    // Mettre √† jour les textes des onglets
    updateTabTexts(lang);
    
    // Mettre √† jour les textes des boutons
    updateButtonTexts(lang);
    
    // Mettre √† jour les textes des widgets
    updateWidgetTexts(lang);
    
    // Mettre √† jour les √©l√©ments sp√©cifiques
    updateSpecificElements(lang);
    
    // Mettre √† jour les attributs title des boutons de langue
    updateLanguageButtonTitles(lang);
    
    // Mettre √† jour l'attribut lang du document
    document.documentElement.lang = lang;
    
    // Stocker la langue pr√©f√©r√©e
    localStorage.setItem('preferredLanguage', lang);
}

// Fonction pour mettre √† jour les textes de statut des √©tapes
function updateStepStatusTexts(lang) {
    const statusElements = document.querySelectorAll('.step-status-h');
    statusElements.forEach(element => {
        const stepElement = element.closest('.mission-step-horizontal');
        if (!stepElement) return;
        
        const stepId = stepElement.id;
        
        // Texte sp√©cial pour l'√©tape d'upload
        if (stepId === 'step-upload-h') {
            element.textContent = translations[lang]['file_detected_status'];
        } else {
            // Pour les autres √©tapes, utiliser le statut par d√©faut
            element.textContent = translations[lang]['status_pending'];
        }
    });
}

// Fonction pour mettre √† jour les textes dynamiques suppl√©mentaires
function updateDynamicTexts(lang) {
    // Mettre √† jour les textes des widgets et sections
    const sectionHeaders = [
        { selector: '.workflow-header h3', key: 'workflow_automation' },
        { selector: '.dashboard-header h3', key: 'bi_analytics' },
        { selector: '.detection-info h3', key: 'file_detected' },
        { selector: '.detection-info p', key: 'auto_detection' },
        { selector: '.ready-status span', key: 'system_ready' },
        { selector: '.feed-header h4', key: 'real_time_activity' },
        { selector: '.diagram-header h4', key: 'workflow_diagram' },
        { selector: '.chart-header h4', key: 'metric_evolution' }
    ];
    
    sectionHeaders.forEach(item => {
        const element = document.querySelector(item.selector);
        if (element && translations[lang][item.key]) {
            element.textContent = translations[lang][item.key];
        }
    });
    
    // Mettre √† jour les textes des boutons
    const buttons = [
        { selector: '#executeWorkflowBtn span', key: 'execute_workflow' },
        { selector: '#pauseWorkflowBtn span', key: 'pause' },
        { selector: '#stopWorkflowBtn span', key: 'stop' },
        { selector: '.refresh-btn', key: 'refresh' },
        { selector: '.reset-btn', key: 'test_reset' }
    ];
    
    buttons.forEach(button => {
        const element = document.querySelector(button.selector);
        if (element && translations[lang][button.key]) {
            element.textContent = translations[lang][button.key];
        }
    });
    
    // Mettre √† jour les textes des info-bulles
    const infoItems = document.querySelectorAll('.info-label');
    infoItems.forEach(item => {
        const text = item.textContent.replace(':', '');
        if (translations[lang][text.toLowerCase()]) {
            item.textContent = translations[lang][text.toLowerCase()] + ':';
        }
    });
    
    // Mettre √† jour les textes de l√©gende
    const legendItems = document.querySelectorAll('.legend-item');
    if (legendItems.length >= 4) {
        legendItems[0].textContent = translations[lang]['legend_pending'];
        legendItems[1].textContent = translations[lang]['legend_running'];
        legendItems[2].textContent = translations[lang]['legend_completed'];
        legendItems[3].textContent = translations[lang]['legend_error'];
    }
    
    // Mettre √† jour les textes des n≈ìuds du workflow
    const nodeLabels = document.querySelectorAll('.node-label');
    nodeLabels.forEach(node => {
        const text = node.textContent;
        if (text.includes('D√©marrage') || text.includes('Start')) {
            node.textContent = translations[lang]['start'];
        } else if (text.includes('Compl√®te') || text.includes('Comprehensive')) {
            node.textContent = translations[lang]['comprehensive_analysis'];
        } else if (text.includes('Classification')) {
            node.textContent = translations[lang]['ia_classification'];
        } else if (text.includes('PMR')) {
            node.textContent = translations[lang]['pmr_analysis'];
        } else if (text.includes('Co√ªts') || text.includes('Cost')) {
            node.textContent = translations[lang]['cost_prediction'];
        } else if (text.includes('Environnementale') || text.includes('Environmental')) {
            node.textContent = translations[lang]['environmental_analysis'];
        } else if (text.includes('Optimisation') || text.includes('Optimization')) {
            node.textContent = translations[lang]['ia_optimization'];
        } else if (text.includes('Anomalies') || text.includes('Anomaly')) {
            node.textContent = translations[lang]['anomaly_detection'];
        } else if (text.includes('Assistant')) {
            node.textContent = translations[lang]['ia_assistant'];
        } else if (text.includes('Final') || text.includes('Final')) {
            node.textContent = translations[lang]['final_report'];
        }
    });
}

// Fonction pour mettre √† jour les titres des boutons de langue
function updateLanguageButtonTitles(lang) {
    document.querySelectorAll('.lang-btn').forEach(btn => {
        const langCode = btn.getAttribute('data-lang');
        if (langCode === 'fr') {
            btn.setAttribute('title', 'Fran√ßais');
        } else if (langCode === 'en') {
            btn.setAttribute('title', 'English');
        } else if (langCode === 'de') {
            btn.setAttribute('title', 'Deutsch');
        }
    });
}

// Fonction pour mettre √† jour les textes des onglets
function updateTabTexts(lang) {
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
        const text = tab.textContent.trim();
        if (text.includes('Analyse') || text.includes('Analysis') || text.includes('Analyse')) {
            tab.textContent = translations[lang]['tab_analysis'];
        } else if (text.includes('Anomalies') || text.includes('Anomalies') || text.includes('Anomalien')) {
            tab.textContent = translations[lang]['tab_anomalies'];
        } else if (text.includes('Classification') || text.includes('Classification') || text.includes('Klassifizierung')) {
            tab.textContent = translations[lang]['tab_classification'];
        } else if (text.includes('PMR') || text.includes('PMR') || text.includes('PMR')) {
            tab.textContent = translations[lang]['tab_pmr'];
        } else if (text.includes('Co√ªts IA') || text.includes('AI Costs') || text.includes('KI-Kosten')) {
            tab.textContent = translations[lang]['tab_costs'];
        } else if (text.includes('Environnement') || text.includes('Environment') || text.includes('Umwelt')) {
            tab.textContent = translations[lang]['tab_environment'];
        } else if (text.includes('Optimisation IA') || text.includes('AI Optimization') || text.includes('KI-Optimierung')) {
            tab.textContent = translations[lang]['tab_optimization'];
        } else if (text.includes('Assistant IA') || text.includes('AI Assistant') || text.includes('KI-Assistent')) {
            tab.textContent = translations[lang]['tab_assistant'];
        }
    });
}

// Fonction pour mettre √† jour les textes des boutons
function updateButtonTexts(lang) {
    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => {
        const buttonText = button.textContent.trim();
        
        // Workflow buttons
        if (buttonText.includes('Ex√©cuter Workflow Complet') || buttonText.includes('Execute Full Workflow') || buttonText.includes('Vollst√§ndigen Workflow ausf√ºhren')) {
            if (button.querySelector('span')) {
                button.querySelector('span').textContent = translations[lang]['execute_workflow'];
            } else {
                button.textContent = translations[lang]['execute_workflow'];
            }
        } else if (buttonText.includes('Pause') || buttonText.includes('Pause') || buttonText.includes('Pause')) {
            button.textContent = translations[lang]['pause'];
        } else if (buttonText.includes('Arr√™ter') || buttonText.includes('Stop') || buttonText.includes('Stoppen')) {
            button.textContent = translations[lang]['stop'];
        }
        
        // Analysis buttons
        else if (buttonText.includes('Lancer Analyse Compl√®te') || buttonText.includes('Launch Comprehensive Analysis') || buttonText.includes('Umfassende Analyse starten')) {
            button.textContent = translations[lang]['start_analysis'];
        } else if (buttonText.includes('R√©initialiser') || buttonText.includes('Reset') || buttonText.includes('Zur√ºcksetzen')) {
            button.textContent = translations[lang]['reset'];
        }
        
        // Action buttons
        else if (buttonText.includes('Voir D√©tails') || buttonText.includes('View Details') || buttonText.includes('Details anzeigen')) {
            button.textContent = translations[lang]['view_details'];
        } else if (buttonText.includes('T√©l√©charger') || buttonText.includes('Download') || buttonText.includes('Herunterladen')) {
            button.textContent = translations[lang]['download_report'];
        }
        
        // Navigation buttons
        else if (buttonText.includes('Pr√©c√©dent') || buttonText.includes('Previous') || buttonText.includes('Zur√ºck')) {
            button.textContent = translations[lang]['previous'] || 'Pr√©c√©dent';
        } else if (buttonText.includes('Suivant') || buttonText.includes('Next') || buttonText.includes('Weiter')) {
            button.textContent = translations[lang]['next'] || 'Suivant';
        } else if (buttonText.includes('Fermer') || buttonText.includes('Close') || buttonText.includes('Schlie√üen')) {
            button.textContent = translations[lang]['close'] || 'Fermer';
        }
    });
    
    // Update buttons with icons and text
    const iconButtons = document.querySelectorAll('button i + span, button span + i');
    iconButtons.forEach(button => {
        const buttonText = button.textContent.trim();
        if (buttonText.includes('Ex√©cuter Workflow Complet') || buttonText.includes('Execute Full Workflow') || buttonText.includes('Vollst√§ndigen Workflow ausf√ºhren')) {
            button.textContent = translations[lang]['execute_workflow'];
        } else if (buttonText.includes('Pause') || buttonText.includes('Pause') || buttonText.includes('Pause')) {
            button.textContent = translations[lang]['pause'];
        } else if (buttonText.includes('Arr√™ter') || buttonText.includes('Stop') || buttonText.includes('Stoppen')) {
            button.textContent = translations[lang]['stop'];
        }
    });
}

// Fonction pour mettre √† jour les textes des widgets
function updateWidgetTexts(lang) {
    // Update metric texts
    const metricElements = document.querySelectorAll('.metric-value, .metric-label, .metric-title');
    metricElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Qualit√©') || text.includes('Quality') || text.includes('Qualit√§t')) {
            element.textContent = translations[lang]['quality'];
        } else if (text.includes('Conformit√©') || text.includes('Compliance') || text.includes('Konformit√§t')) {
            element.textContent = translations[lang]['compliance'];
        } else if (text.includes('Compl√©tude') || text.includes('Completeness') || text.includes('Vollst√§ndigkeit')) {
            element.textContent = translations[lang]['completeness'];
        }
    });
    
    // Update widget headers
    const widgetHeaders = document.querySelectorAll('.widget-header h4, .dashboard-header h3, .dashboard-header h4, .widget-title, .section-title');
    widgetHeaders.forEach(header => {
        const originalText = header.textContent;
        if (originalText.includes('Sant√© du Projet') || originalText.includes('Project Health') || originalText.includes('Projektzustand')) {
            header.textContent = translations[lang]['project_health'];
        } else if (originalText.includes('Distribution des Anomalies') || originalText.includes('Anomaly Distribution') || originalText.includes('Anomalieverteilung')) {
            header.textContent = translations[lang]['anomaly_distribution'];
        } else if (originalText.includes('Distribution des √âl√©ments') || originalText.includes('Element Distribution') || originalText.includes('Elementverteilung')) {
            header.textContent = translations[lang]['element_distribution'];
        } else if (originalText.includes('Sant√© du Syst√®me') || originalText.includes('System Health') || originalText.includes('Systemzustand')) {
            header.textContent = translations[lang]['system_health'];
        }
    });
    
    // Update workflow elements
    const workflowElements = document.querySelectorAll('.node-label, .flow-label, .workflow-label');
    workflowElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('D√©marrage') || text.includes('Start') || text.includes('Start')) {
            element.textContent = translations[lang]['start'] || 'D√©marrage';
        } else if (text.includes('Analyse') || text.includes('Analysis') || text.includes('Analyse')) {
            element.textContent = translations[lang]['comprehensive_analysis'];
        }
    });
    
    // Update status and message texts
    const statusElements = document.querySelectorAll('.status-text, .message-text, .info-text, .step-status');
    statusElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Fichier D√©tect√© Automatiquement') || text.includes('File Automatically Detected') || text.includes('Datei automatisch erkannt')) {
            element.textContent = translations[lang]['file_detected_auto'];
        } else if (text.includes('En attente') || text.includes('Pending') || text.includes('Ausstehend')) {
            element.textContent = translations[lang]['status_pending'];
        } else if (text.includes('En cours') || text.includes('Running') || text.includes('L√§uft')) {
            element.textContent = translations[lang]['status_running'];
        } else if (text.includes('Termin√©') || text.includes('Completed') || text.includes('Abgeschlossen')) {
            element.textContent = translations[lang]['status_completed'];
        }
    });
}

// Fonction pour mettre √† jour les √©l√©ments sp√©cifiques
function updateSpecificElements(lang) {
    // Update "Diagramme de Workflow"
    const workflowDiagramElements = document.querySelectorAll('h4, h3, .title, .header');
    workflowDiagramElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Diagramme de Workflow') || text.includes('Workflow Diagram') || text.includes('Workflow-Diagramm')) {
            element.textContent = translations[lang]['workflow_diagram'];
        }
    });
    
    // Update "Anomalie-Heatmap"
    const heatmapElements = document.querySelectorAll('h4, h3, .title, .header');
    heatmapElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Heatmap des Anomalies') || text.includes('Anomalies Heatmap') || text.includes('Anomalie-Heatmap')) {
            element.textContent = translations[lang]['anomalies_heatmap'];
        }
    });
    
    // Update "Timeline des Analyses"
    const timelineElements = document.querySelectorAll('h4, h3, .title, .header');
    timelineElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Timeline des Analyses') || text.includes('Analysis Timeline') || text.includes('Analyse-Zeitplan')) {
            element.textContent = translations[lang]['timeline_analyses'];
        }
    });
    
    // Update "Pr√©dicteur de Co√ªts IA"
    const costPredictorElements = document.querySelectorAll('h4, h3, .title, .header');
    costPredictorElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Pr√©dicteur de Co√ªts IA') || text.includes('AI Cost Predictor') || text.includes('KI-Kostenprognose')) {
            element.textContent = translations[lang]['cost_predictor_ai'];
        }
    });
    
    // Update "Radar de Performance Multi-Dimensionnel"
    const performanceRadarElements = document.querySelectorAll('h4, h3, .title, .header');
    performanceRadarElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Radar de Performance Multi-Dimensionnel') || text.includes('Multi-Dimensional Performance Radar') || text.includes('Mehrdimensionales Leistungsradar')) {
            element.textContent = translations[lang]['performance_radar'];
        }
    });
    
    // Update "Intelligence Pr√©dictive BIM"
    const predictiveIntelligenceElements = document.querySelectorAll('h4, h3, .title, .header');
    predictiveIntelligenceElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Intelligence Pr√©dictive BIM') || text.includes('BIM Predictive Intelligence') || text.includes('BIM-Pr√§diktive Intelligenz')) {
            element.textContent = translations[lang]['predictive_intelligence'];
        }
    });
    
    // Update "BIM Intelligence Hub"
    const bimIntelligenceHubElements = document.querySelectorAll('h4, h3, .title, .header');
    bimIntelligenceHubElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('BIM Intelligence Hub') || text.includes('BIM Intelligence Hub') || text.includes('BIM-Intelligenz-Hub')) {
            element.textContent = translations[lang]['bim_intelligence_hub'];
        }
    });
    
    // Update "Analyse BIM Intelligente"
    const intelligentBimAnalysisElements = document.querySelectorAll('h4, h3, .title, .header');
    intelligentBimAnalysisElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Analyse BIM Intelligente') || text.includes('Intelligent BIM Analysis') || text.includes('Intelligente BIM-Analyse')) {
            element.textContent = translations[lang]['intelligent_bim_analysis'];
        }
    });
    
    // Update "Innovation Lab"
    const innovationLabElements = document.querySelectorAll('h4, h3, .title, .header');
    innovationLabElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Innovation Lab') || text.includes('Innovation Lab') || text.includes('Innovationslabor')) {
            element.textContent = translations[lang]['innovation_lab'];
        }
    });
    
    // Update "Smart Performance Dashboard"
    const smartPerformanceElements = document.querySelectorAll('h4, h3, .title, .header');
    smartPerformanceElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Smart Performance Dashboard') || text.includes('Smart Performance Dashboard') || text.includes('Intelligentes Leistungsdashboard')) {
            element.textContent = translations[lang]['smart_performance_dashboard'];
        }
    });
    
    // Update "Analyse S√©mantique BIM"
    const semanticAnalysisElements = document.querySelectorAll('h4, h3, .title, .header');
    semanticAnalysisElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Analyse S√©mantique BIM') || text.includes('BIM Semantic Analysis') || text.includes('BIM-Semantikanalyse')) {
            element.textContent = translations[lang]['semantic_bim_analysis'];
        }
    });
    
    // Update "Matrice de Connectivit√©"
    const connectivityMatrixElements = document.querySelectorAll('h4, h3, .title, .header');
    connectivityMatrixElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Matrice de Connectivit√©') || text.includes('Connectivity Matrix') || text.includes('Konnektivit√§tsmatrix')) {
            element.textContent = translations[lang]['connectivity_matrix'];
        }
    });
    
    // Update "Analyse G√©om√©trique Avanc√©e"
    const geometricAnalysisElements = document.querySelectorAll('h4, h3, .title, .header');
    geometricAnalysisElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Analyse G√©om√©trique Avanc√©e') || text.includes('Advanced Geometric Analysis') || text.includes('Erweiterte geometrische Analyse')) {
            element.textContent = translations[lang]['geometric_analysis'];
        }
    });
    
    // Update "Fichier D√©tect√© Automatiquement"
    const fileDetectedElements = document.querySelectorAll('h3, h4, .title, .header');
    fileDetectedElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Fichier D√©tect√© Automatiquement') || text.includes('File Automatically Detected') || text.includes('Datei automatisch erkannt')) {
            element.textContent = translations[lang]['file_detected_auto'];
        }
    });
    
    // Update "Activit√© en Temps R√©el"
    const realTimeActivityElements = document.querySelectorAll('h4, h3, .title, .header');
    realTimeActivityElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Activit√© en Temps R√©el') || text.includes('Real-time Activity') || text.includes('Echtzeit-Aktivit√§t')) {
            element.textContent = translations[lang]['real_time_activity'];
        }
    });
    
    // Update "Analytics BI en Temps R√©el"
    const realTimeAnalyticsElements = document.querySelectorAll('h3, h4, .title, .header');
    realTimeAnalyticsElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.includes('Analytics BI en Temps R√©el') || text.includes('Real-time BI Analytics') || text.includes('Echtzeit-BI-Analytik')) {
            element.textContent = translations[lang]['real_time_analytics'];
        }
    });
}

// Fonctions utilitaires
function forceUpdateAllTexts(lang) {
    updateInterface(lang);
    updateTabTexts(lang);
    updateButtonTexts(lang);
    updateWidgetTexts(lang);
    updateSpecificElements(lang);
}

function getCurrentLanguage() {
    return localStorage.getItem('preferredLanguage') || 'fr';
}

function hasTranslation(key, lang) {
    return translations[lang] && translations[lang][key];
}

function getTranslation(key, lang) {
    return translations[lang] && translations[lang][key] ? translations[lang][key] : key;
}

// Initialiser la langue au chargement de la page
document.addEventListener('DOMContentLoaded', function() {
    const savedLanguage = localStorage.getItem('preferredLanguage') || 'fr';
    changeLanguage(savedLanguage);
    
    // Ajouter les √©couteurs d'√©v√©nements pour les boutons de langue
    const langButtons = document.querySelectorAll('.lang-btn');
    langButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const lang = this.getAttribute('data-lang');
            changeLanguage(lang);
        });
    });
});